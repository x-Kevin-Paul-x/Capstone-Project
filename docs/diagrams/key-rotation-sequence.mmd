sequenceDiagram
    participant KMS as Key Management Service
    participant REPO as Certificate Store
    participant DEV as Robot Device
    participant TPM as TPM/Secure Element

    Note over KMS,TPM: Scheduled Key Rotation
    KMS->>KMS: Generate new keypair
    KMS->>REPO: Publish new certificates
    KMS->>DEV: Send rotation notification
    
    DEV->>REPO: Request new certificate bundle
    REPO-->>DEV: Send new certificates
    
    DEV->>TPM: Store new public keys
    DEV->>DEV: Update bootloader key store
    
    Note over KMS,TPM: Overlap Period
    DEV->>DEV: Accept both old and new keys
    
    Note over KMS,TPM: Old Key Expiration
    KMS->>REPO: Mark old certificates as revoked
    DEV->>TPM: Remove expired keys
    KMS->>KMS: Archive old private keys securely